(function(){window.hoverMenu=function(a,b=["none"],c={}){this._keeper={open:[],click:[],close:[]},this.state=!1,this.selector=a,this._hBind(),this.name=`hoverMenu-${new Date().getTime()}`,$("body").append(`<ul id="${this.name}"></ul>`),this.ROOT=$(`#${this.name}`).css({position:"fixed","z-index":"999"}).hide(),c.style&&this.ROOT.css(c.style),c.classes&&c.classes.forEach(a=>this.ROOT.addClass(a)),this.menuParser(b)},window.hoverMenu.prototype={on(a,b){if(-1===Object.keys(this._keeper).indexOf(a))throw"Invalid event name";if("function"!=typeof b)throw"Handler must be a function";return this._keeper[a].push(b),this},unbind(a){if(-1===Object.keys(this._keeper).indexOf(a))throw"Invalid event name";return this._keeper[a]=[],this},update(){return $(this.selector).unbind("contextmenu").on("contextmenu",a=>(this.open(a.pageX,a.pageY),this._call(this._keeper.open,[a]),(a.preventDefault(),!1))),this},_hBind(){this.update(),$("body").click(a=>{let b=$(a.target);if(0<b.parent(`#${this.name}`).length){let a=b;if(0<b.parent("li").parent(`#${this.name}`).length&&(a=b.parent("li")),this._call(this._keeper.click,[a.attr("data-id"),a]),a.is("[stay]"))return!0}this.state&&this.close()})},_call(a,b){if("object"!=typeof a)throw"Invalid type of array";0<Object.values(a).length&&a.forEach(a=>a(...b))},menuParser(a){if("object"!=typeof a)throw"Invalid type of menu";this.ROOT.html(""),Object.values(a).forEach((a,b)=>{if("string"==typeof a)return this.ROOT.append(`<li data-id="${b}">${a}</li>`);this.ROOT.append(`<li data-id="${b}">${a.text}</li>`);let d=this.ROOT.children(`li[data-id=${b}]`);a.action&&d.attr("stay",""),a.classes&&a.classes.forEach(a=>d.addClass(a)),a.style&&d.css(a.style)})},open(a,b){return this.state=!0,this.ROOT.offset({left:a,top:b}).show(),this},close(){return this.state=!1,this.ROOT.offset({top:0,left:0}).hide(),this}}})();