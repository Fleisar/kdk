(function(){window.configCollector=function(a={}){this.class=a.class||"config-collector",this._keeper={update:[]},this.config={},this.update(),this._load()&&(this.config=JSON.parse(localStorage.getItem("configCollector")),$(()=>{Object.keys(this.config).forEach(a=>{0<this._keeper.update.length&&this._keeper.update.forEach(b=>b(a,this.config[a]));let b=$(`.${this.class}[name=${a}]`);switch(b[0].tagName){case"INPUT":if("checkbox"===b[0].type)return b.prop("checked",this.config[a]);case"SELECT":default:return b.val(this.config[a]);}})}))},window.configCollector.prototype={update(){$(`.${this.class}`).unbind("change").change(a=>{this.config[a.target.name]=this._value(a.target),0<this._keeper.update.length&&this._keeper.update.forEach(b=>b(a.target.name,this.config[a.target.name])),this._save()})},change(a){if("function"!=typeof a)throw"Handler must be a function";this._keeper.update.push(a)},collect(){return $(`.${this.class}`).each((a,b)=>{this.config[b.name]=this._value(b)}),this.config},_value(a){switch(a.tagName){case"INPUT":if("checkbox"===a.type)return $(a).is(":checked");case"SELECT":default:return $(a).val();}},_load(){return localStorage.hasOwnProperty("configCollector")},_save(){localStorage.setItem("configCollector",JSON.stringify(this.config))}}})();